<!DOCTYPE html>
<html>
<head>
<style>
table, th, td {
  border: 1px solid black;
}
</style>
</head>
<body>
<h1>
因果推断
</h1>
<p>07 January 2024</p>
<h3>
<ol type="1">
<li>缘起
</h3></li>
</ol>
<p>几个月前，在一个微信群里面聊起用最小二乘法作为一个入门例子介绍机器学习的想法，简单列举了基本的想法和逐渐深入介绍机器学习的主要概念的步骤。一位朋友觉得不错，遂提议是否可以如法泡制，介绍一下因果推断？</p>
<p>但我对因果推断是两眼一抹黑，只是听说过这个概念，根本就不了解它的思想方法。答应可以作为一个homework来做，但什么时候完成，自己心里也没数。于是这几个月下来，有一搭没一搭地看了一些资料，过程中有一些个人体会。趁着圣诞新年假期，做一个小结。既不是入门介绍，也不是用一个例子来说明因果推断的主要思想。只是一些个人想法，肯定会有不着调的地方:)</p>
<h3>
<ol start="2" type="1">
<li>什么是因果？
</h3></li>
</ol>
<p>说因果推断， 我们首先要回答“什么是因果？” 可惜的是，这个问题并没有一个大家都接受的严格定义！物理学家有他们的因果，哲学家有他们的因果，而宗教（如佛教）也有他们的因果。</p>
<p>《韦氏词典》给出的解释为：因果关系是指一个行动/动作或者事件和它的结果或者后果之间的直接关系。cause and effect: the direct relationship between an action or event and its consequence or result<a href="https://www.merriam-webster.com/dictionary/cause%20and%20effect" </a>  
Wikipedia的词条是这样的：因果关系(英语：causality 或 causation)，又称为因果性，简称因果，是一个事件(即“因”)和第二个事件(即“果”)之间的作用关系，其中后一事件被认为是前一事件的结果。一般来说，一个事件是很多原因综合产生的结果，而且原因都发生在较早时间点，而该事件又可以成为其他事件的原因。</p>
<p>需要注意的是这里的因，是指一个事件或者动作/行动，按照数学语言来说的话，就是一个变量的变化/改变，暗含了这个变量有变化前和变化后两个状态，强调的是“对照/对比”的概念。还有一点是大家都心照不宣地约定，讨论因果关系时，假设其它条件都保持不变！</p>
<p>因果关系在参考文献[1]的定义是解释变量X的变化(因)导致被解释变量Y的变化(果)，也可以通过潜在结果模型定义为处置效应。 [Pearl][2](p5)则简单定义为： A variable X is a cause of a variable Y if Y in any way relies on X for its value. (如果变量Y的取值以某种方式依赖于X，则变量X称为变量Y的原因) 这个定义显然太宽泛了，以至于任何相关性都可归结为因果关系！但其实看了一段时间的资料后，发现其实这个定义也有它的道理，在一定的条件下也是对的。</p>
<p>关于因果推断的适用范围，有两点需要注意：<br />
1. 统计推断作为统计学的一个分支，是没法对单独的个体进行因果推断的，它只能是针对一个群体或者集合。<br />
2. 根据[丁鹏][3]的说法，因果推断能做的是从“因”到“果”，而不是从“果”到“因”。我的理解是，因果推断的因和果都必须是确定的变量（的变化)，而不是对于一个给定的果，在一堆未知的变量中去找原因。</p>
<p>如果是我来下定义的话，会采用如下的方式：</p>
<p>定义1: 给定一个集合S，它的每个元素都有N个属性/变量(N&gt;=2)。X和Y是系统S的元素的两个变量，如果在其它变量保持不变(保持一致)的情况下，X的改变(记这个事件为C)引起了Y 的改变(记为事件E)，那么称C与E之间有因果关系，并且称C为E的因，E为C的果。<br />
定义1’: 给定一个集合S，它的每个元素都有N个属性/变量(N&gt;=2)。X和Y是系统S的元素的两个变量，如果可以忽略(S的元素)其它变量的影响，X的改变(记这个事件为C)引起了Y 的改变(记为事件E)，那么称C与E之间有因果关系，并且称C为E的因，E为C的果。</p>
<p>这种定义方式把大家心照不宣的东西明确包含在定义里面。不过，我们在下一节会发现，正是这部分内容，让因果推断很难有一个大家都接受的做法。其中的关键是“其它变量”，究竟是指什么变量？让其它变量保持不变(保持一致)，或 忽略(S的元素)其它变量的影响，是否有可操作性？如果可操作，那么该怎么做？</p>
<h3>
<ol start="3" type="1">
<li>描述对象的变量
</h3></li>
</ol>
<p>下面我们要回答一个“根本性”的问题：怎么描述一个系统或者我们感兴趣的研究对象？</p>
<p>学生时代经常碰到的一个问题，就是描述一个系统的状态，比如说学习二阶常微分方程的时候讨论运动方程，就把质点的位置和速度作为状态变量，整个问题的目标就是找到它们和时间的关系。质点本身已经是一个理想化抽象化的数学概念，它只有质量，位置，速度和加速度等几个属性/变量，我们比较容易根据物理定律写出这些变量随时间的变化规律。</p>
<p>然而，在实证研究(empirical studies)中碰到的绝大多数问题，尤其是和人群群体行为或者群体属性有关的问题，要比质点运动方程复杂得多得多：因为在这种情况下，每个个体其实都有无穷多个属性/变量（年龄、性别、肤色、教育程度、成长背景、健康状况、心理素质、身高、体重、甚至基因数据等等），我们选择哪些属性/变量作为描述我们感兴趣的系统的“状态”（做机器学习的人称为特征选取），实际上是没有统一标准的：它当然依赖于我们研究的目的(我们通过研究这个问题究竟要干什么)，同时也和研究人员自己的主观选择有关。</p>
<p>正是这个复杂性，让因果推断变得非常困难。即使用我们这里提出的定义，也没法进行可验证的操作：保持“其它变量”不变（一致）？哪些变量，怎么保持，都是问题。</p>
<p>从这里，我们其实可以这样说：因果推断得到的结论，我们不能以“对”或者“错”来评价，只能说得到的结论是否“合理”，是否有助于我们或者我们的客户以后做相关决策的时候可以做更好的选择。这其实和绝大多数data science projects的评判标准是类似的：根据数据来讨论方法，就事论事/case by case/具体情况具体分析，而不能盲目“推而广之”。</p>
<h3>
<ol start="4" type="1">
<li>怎么做因果推断？
</h3></li>
</ol>
<p>尽管我们前面的分析说，“严格”的因果推断在实证研究中是非常困难的，但这并不妨碍我们在一些具体的例子中利用现在已有的方法/工具进行因果分析，为一些具体问题其提供一些useful insights.</p>
<p>现在的因果推断主要有两种方法：Rubin的Causal Model (RCM)和Pearl的Causal Diagram (CD)。RCM是基于随机化的潜在结果(potential outcomes)模型,而CD则是通过引入do算子在DAG表示因果关系。</p>
<p>[M. Facure][4]提供了一些Python例子怎么做因果推断，不过我没来得及仔细看，不知道实际效果怎么样。[丁鹏][5]是丁鹏在Berkeley加州大学讲授《因果推断》的讲义(我也是前几天刚发现)，应该是不错的参考资料。</p>
<h3>
参考文献：
</h3>
<p>[1] 邱嘉平，因果推断实用计量方法，上海财经大学出版社，2020.<br />
[2] J. Pearl et al, Causal Inference in Statistics A Primer, Wiley, 2016.<br />
[3] 丁鹏，因果推断简介系列，统计之都。<br />
[4] M. Facure, Causal Inference in Python, 2023.<br />
[5] P. Ding, A First Course in Causal Inference, https://arxiv.org/abs/2305.18793</p>

</body>
</html>
